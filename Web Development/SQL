/* ASSIGNMENT QUESTIONS ON GROUP BY. */

/* 1. WAQTD NUMBER OF EMPLOYEES WORKING IN EACH DEPARTEMENT EXCEPT PRESIDENT. */
SELECT COUNT(*),DEPTNO
FROM EMP
WHERE JOB != 'PRESIDENT'
GROUP BY DEPTNO;

/* 2. WAQTD TOTAL SALARY NEEDED TO PAY ALL THE EMPLOYEES IN EACH JOB. */
SELECT SUM(SAL) "TOTAL SAL",JOB
FROM EMP
GROUP BY JOB;

/* 3. WAQTD NUMBER OF EMPLOYEES WORKING AS MANAGER IN EACH DEPARTMENT. */
SELECT COUNT(*),DEPTNO
FROM EMP
WHERE JOB = 'MANAGER'
GROUP BY DEPTNO;

/* 4. WAQTD AVG SALARY NEEDED TO PAY ALL THE EMPLOYEES IN EACH DEPARTMENT EXCLUDING THE EMPLOYEES OF DEPTNO 20. */
SELECT AVG(SAL),DEPTNO
FROM EMP
WHERE DEPTNO !=20
GROUP BY DEPTNO;

/* 5. WAQTD NUMBER OF EMPLOYEES HAVING CHARACTER 'A' IN THEIR NAMES IN EACH JOB. */
SELECT COUNT(*),JOB
FROM EMP
WHERE ENAME LIKE '%A%'
GROUP BY JOB;

/* 6. WAQTD NUMBER OF EMPLOYEES AND AVG SALARY NEEDED TO PAY THE EMPLOYEES WHO SALARY IN GREATER THAN 2000 IN EACH DEPT. */
SELECT COUNT(*),AVG(SAL) "AVG SAL",DEPTNO
FROM EMP
WHERE SAL > 2000
GROUP BY DEPTNO;

/* 7. WAQTD TOTAL SALARY NEEDED TO PAY AND NUMBER OF SALESMANS IN EACH DEPT. */
SELECT SUM(SAL),COUNT(*) "SALESMAN",DEPTNO
FROM EMP
WHERE JOB = 'SALESMAN'
GROUP BY DEPTNO;

/* 8. WAQTD NUMBER OF EMPLOYEES WITH THEIR MAXIMUM SALARIES IN EACH JOB. */
SELECT COUNT(*),MAX(SAL) "MAX SAL",JOB
FROM EMP
GROUP BY JOB;

/* 9. WAQTD MAXIMUM SALARIES GIVEN TO AN EMPLOYEE WORKING IN EACH DEPT. */
SELECT MAX(SAL) "MAX SAL",DEPTNO
FROM EMP
GROUP BY DEPTNO;

/* 10. WAQTD NUMBER OF TIMES THE SALARIES PRESENT IN EMPLOYEE TABLE. */
SELECT COUNT(*),SAL
FROM EMP
GROUP BY SAL;

/* 11. WAQTD NUMBER OF EMPLOYEES WORKING IN EACH DEPARTEMENT AND EARNING SAME SALARY. */
SELECT COUNT(*),DEPTNO,SAL
FROM EMP
GROUP BY DEPTNO,SAL;

/* 12. WAQTD NUMBER OF EMPLOYEES WORKING IN EACH DEPARTMENT AND HIRED ON SAME DAY? */
SELECT COUNT(*),DEPTNO,HIREDATE
FROM EMP
GROUP BY DEPTNO,HIREDATE;

________________________________________________________________________________________

/* ASSIGNMENT QUESTIONS ON HAVING CLAUSE. */

/* 1. WAQTD DNO AND NUMBER OF EMP WORKING IN EACH DEPT IF THERE ARE ATLEAST 2 CLERKS IN EACH DEPT. */
SELECT COUNT(*),DEPTNO
FROM EMP
WHERE JOB = 'CLERK'
GROUP BY DEPTNO
HAVING COUNT(*) >=2;

/* 2. WAQTD DNO AND TOTAL SALARY NEEDED TO PAY ALL EMP IN EACH DEPT IF THERE ARE ATLEAST 4 EMP IN EACH DEPT. */
SELECT DEPTNO,SUM(SAL) "TOTAL SAL"
FROM EMP
GROUP BY DEPTNO
HAVING COUNT(*) >=4;

/* 3. WAQTD NUMBER OF EMP EARNING SAL MORE THAN 1500 IN EACH JOB AND THE TOTAL SAL NEEDED TO PAY EMP OF EACH JOB MUST EXCEES 2500. */
SELECT COUNT(*),JOB,SUM(SAL) "TOTAL SAL"
FROM EMP
WHERE SAL > 1500
GROUP BY JOB
HAVING SUM(SAL) > 2500;

/* 4. WAQTD DEPTNO AND NUMBER OF EMP WORKING ONLY IF THERE ARE 2 EMP WORKING IN EACH DEPT AS MANAGER. */
SELECT DEPTNO,COUNT(*)
FROM EMP
WHERE JOB = 'MANAGER'
GROUP BY DEPTNO
HAVING COUNT(*) = 2;

/* 5. WAQTD JOB AND MAX SAL OF EMP IN EACH JOB IF THE MAX SAL EXCEEDS 2600. */
SELECT JOB,MAX(SAL) "MAX SAL"
FROM EMP
GROUP BY JOB
HAVING MAX(SAL) > 2600;

/* 6. WAQTD THE SALARIES WHICH ARE REPEATED IN EMP TABLE. */
SELECT SAL,COUNT(*)
FROM EMP
GROUP BY SAL
HAVING COUNT(*) > 1;

/* 7. WAQTD THE HIREDATE WHICH ARE DUPLICATED IN EMP TABLE. */
SELECT HIREDATE,COUNT(*)
FROM EMP
GROUP BY HIREDATE
HAVING COUNT(*) > 1;

/* 8. WAQTD AVG SALARY OF EACH DEPT IF AVG SAL IS LESS THAN 3000. */
SELECT AVG(SAL) "AVG SAL",DEPTNO
FROM EMP
GROUP BY DEPTNO
HAVING AVG(SAL) < 3000;

/* 9. WAQTD DEPTNO IF THERE ARE ATLEAST 3 EMP IN EACH DEPT WHOS NAME HAS CHAR 'M' OR 'J'. */
SELECT DEPTNO,COUNT(*)
FROM EMP
WHERE ENAME LIKE '%M%' OR ENAME LIKE '%J%'
GROUP BY DEPTNO
HAVING COUNT(*) > 3;

/* 10. WAQTD MIN AND MAX SALARIES OF EACH JOB IF MIN SAL IS MORE THAN 1000 AND MAX SAL IS LESS THAN 5000. */
SELECT MIN(SAL) "MIN SAL",MAX(SAL) "MAX SAL",JOB
FROM EMP
GROUP BY JOB
HAVING MIN(SAL) > 3000 AND MAX(SAL) < 5000;

/* 11. WAQTD JOB WISE MAXIMUM SALARY IF THE MAXIMUM SALARY OF EACH JOB EXCEEDS 2000. */
SELECT JOB,MAX(SAL) "MAX SAL"
FROM EMP
GROUP BY JOB
HAVING MAX(SAL) > 2000;

/* 12. WAQTD NUMBER OF EMP EARNING SAL MORE THAN 1200 IN EACH JOB AND THE TOTAL SAL NEEDED TO PAY EMP OF EACH JOB MUST EXCEEDS 3800. */
SELECT COUNT(*),JOB,SUM(SAL) "TOTAL SAL"
FROM EMP
WHERE SAL > 1200
GROUP BY JOB
HAVING SUM(SAL) > 3800;
_________________________________________________________________________________________________________________________________

/* ASSIGNMENT ON CASE-1 SUB QUERY */

/* 1. WAQTD NAME OF THE EMPLOYEES EARNING MORE THAN ADAMS. */
SELECT ENAME
FROM EMP
where SAL > (SELECT SAL FROM EMP WHERE ENAME = 'ADAMS');

/* 2. WAQTD NAME AND SALARY OF THE EMPLOYEES EARNING LESS THAN KING. */
SELECT ENAME,SAL
FROM EMP
WHERE SAL < (SELECT SAL FROM EMP WHERE ENAME = 'KING');

/* 3. WAQTD NAME AND DEPTNO OF THE EMPLOYEES IF THEY ARE WORKING IN THE SAME DEPT AS JONES. */
SELECT ENAME,DEPTNO
FROM EMP
WHERE DEPTNO = (SELECT DEPTNO FROM EMP WHERE ENAME = 'JONES');

/* 4. WAQTD NAME AND JOB OF ALL THE EMPLOYEES WORKING IN THE SAME DESIGNATION AS JAMES. */
SELECT ENAME,JOB
FROM EMP
WHERE JOB = (SELECT JOB FROM EMP WHERE ENAME ='JAMES');

/* 5. WAQTD EMPNO AND ENAME ALONG WITH ANNUAL SALARY OF ALL THE EMPLOYEES IF THEIR ANNUAL SALARY IS GREATER THAN WARDS ANNUAL SALARY. */
SELECT EMPNO,ENAME,SAL*12 "ANNUAL SAL"
FROM EMP
WHERE SAL*12 > (SELECT SAL*12 FROM EMP WHERE ENAME = 'WARD');

/* 6. WAQTD NAME AND HIREDATE OF THE EMPLOYEES IF THEY ARE HIRED BEFORE SCOTT. */
SELECT ENAME,HIREDATE
FROM EMP
WHERE HIREDATE < (SELECT HIREDATE FROM EMP WHERE ENAME = 'SCOTT');

/* 7. WAQTD NAME AND HIREDATE OF THE EMPLOYEES IF THEY ARE HIRED AFTER THE PRESIDENT. */
SELECT ENAME,HIREDATE
FROM EMP
WHERE HIREDATE > (SELECT HIREDATE FROM EMP WHERE JOB = 'PRESIDENT');

/* 8. WAQTD NAME AND SAL OF THE EMPLOYEE IF THEY ARE EARNING SAL LESS THAN THE EMPLOYEE WHOS EMPNO IS 7839. */
SELECT ENAME,SAL
FROM EMP
WHERE SAL < (SELECT SAL FROM EMP WHERE EMPNO = 7839);

/* 9. WAQTD ALL THE DETAILS OF THE EMPLOYEES IF THE EMPLOYEES ARE HIRED BEFORE MILLER. */
SELECT * FROM EMP
WHERE HIREDATE < (SELECT HIREDATE FROM EMP WHERE ENAME = 'MILLER');

/* 10. WAQTD ENAME AND EMPNO OF THE EMPLOYEES IF EMPLOYEES ARE EARNING MORE THAN ALLEN. */
SELECT ENAME,EMPNO
FROM EMP
WHERE SAL > (SELECT SAL FROM EMP WHERE ENAME = 'ALLEN');

/* 11. WAQTD ENAME AND SALARY OF ALL THE EMPLOYEES WHO ARE EARNING MORE THAN MILLER BUT LESS THAN ALLEN. */
SELECT ENAME,SAL
FROM EMP
WHERE SAL > (SELECT SAL FROM EMP WHERE ENAME = 'MILLER') AND SAL < (SELECT SAL FROM EMP WHERE ENAME = 'ALLEN');

/* 12. WAQTD ALL THE DETAILS OF THE EMPLOYEES WORKING IN DEPT 20 AND WORKING IN THE SAME DESIGNATION AS SMITH. */
SELECT * FROM EMP
WHERE DEPTNO IN(20) AND JOB = (SELECT JOB FROM EMP WHERE ENAME = 'SMITH');

/* 13. WAQTD ALL THE DETAILS OF THE EMPLOYEES WORKING AS MANAGER IN THE SAME DEPT AS TURNER. */
SELECT * FROM EMP
WHERE JOB = 'MANAGER' AND DEPTNO = (SELECT DEPTNO FROM EMP WHERE ENAME = 'TURNER');

/* 14. WAQTD NAME AND HIREDATE OF THE EMPLOYEES HIRED AFTER 1980 AND BEFORE KING. */
SELECT ENAME,HIREDATE
FROM EMP
WHERE HIREDATE > (SELECT HIREDATE FROM EMP WHERE HIREDATE LIKE '%-%-1980') AND HIREDATE < (SELECT HIREDATE FROM EMP WHERE ENAME = 'KING');

/* 15. WAQTD NAME AND SAL ALONG WITH ANNUAL SAL FOR ALL EMPLOYEES WHOS SAL IS LESS THAN BLAKE OR MORE THAN 3500. */
SELECT ENAME,SAL,SAL*12 "ANNUAL SAL"
FROM EMP
WHERE SAL < (SELECT SAL FROM EMP WHERE ENAME = 'BLAKE') OR SAL > 3500;

/* 16. WAQTD ALL THE DETAILS OF EMPLOYEES WHO EARN MORE THAN SCOTT BUT LESS THAN KING. */
SELECT * FROM EMP
WHERE SAL > (SELECT SAL FROM EMP WHERE ENAME = 'SCOTT') AND SAL < (SELECT SAL FROM EMP WHERE ENAME = 'KING');

/* 17. WAQTD NAME OF THE EMPLOYEES WHOS NAME STARTS WITH 'A' AND WORKS IN THE SAME DEPT AS BLAKE. */
SELECT ENAME
FROM EMP
WHERE ENAME LIKE 'A%' AND DEPTNO = (SELECT DEPTNO FROM EMP WHERE ENAME = 'BLAKE');

/* 18. WAQTD NAME AND COMM IF EMPLOYEES EARN COMISSION AND WORK IN THE SAME DESIGNATION AS SMITH. */
SELECT ENAME,COMM
FROM EMP
WHERE COMM IS NOT NULL AND JOB = (SELECT JOB FROM EMP WHERE ENAME = 'SMITH');

/* 19. WAQTD DETAILS OF ALL THE EMPLOYEES WORKING AS CLERK IN THE SAME DEPT AS TURNER. */
SELECT * FROM EMP
WHERE JOB = 'CLERK' AND DEPTNO = (SELECT DEPTNO FROM EMP WHERE ENAME = 'TURNER');

/* 20. WAQTD ENAME, SAL AND DESIGNATION OF THE EMPLOYEES WHOS ANNUAL SALARY IS MORE THAN SMITH AND LESS THAN KING. */
SELECT ENAME,SAL,JOB
FROM EMP
WHERE SAL*12 > (SELECT SAL*12 FROM EMP WHERE ENAME = 'SMITH') AND SAL*12 < (SELECT SAL*12 FROM EMP WHERE ENAME = 'KING');

/* ASSIGNMENT COMPLETED. */
_________________________________________________________________________________________________________________________________

/* ASSIGNMENT ON CASE 2 SUB QUERY */

/* 21. WAQTD DNAME OF THE EMPLOYEES WHOS NAME IS SMITH. */
SELECT DNAME
FROM DEPT
WHERE DEPTNO = (SELECT DEPTNO FROM EMP WHERE ENAME = 'SMITH');

/* 22. WAQTD DNAME AND LOC OF THE EMPLOYEE WHOS ENAME IS KING. */
SELECT DNAME,LOC
FROM DEPT
WHERE DEPTNO = (SELECT DEPTNO FROM EMP WHERE ENAME = 'KING');

/* 23. WAQTD LOC OF THE EMP WHOS EMPLOYEE NUMBER IS 7902. */
SELECT LOC
FROM DEPT
WHERE DEPTNO = (SELECT DEPTNO FROM EMP WHERE EMPNO = 7902);

/* 24. WAQTD DNAME AND LOC ALONG WITH DEPTNO OF THE EMPLOYEE WHOS NAME ENDS WITH 'R'. */
SELECT DNAME,LOC,DEPTNO
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO FROM EMP WHERE ENAME LIKE '%R');

/* 25. WAQTD DNAME OF THE EMPLOYEE WHOS DESIGNATION IS PRESIDENT. */
SELECT DNAME
FROM DEPT
WHERE DEPTNO = (SELECT DEPTNO FROM EMP WHERE JOB = 'PRESIDENT');

/* 26. WAQTD NAMES OF THE EMPLOYEES WORKING IN ACCOUNTING DEPARTMENT. */
SELECT ENAME
FROM EMP
WHERE DEPTNO = (SELECT DEPTNO FROM DEPT WHERE DNAME = 'ACCOUNTING');

/* 27. WAQTD ENAME AND SALARIES OF THE EMPLOYEES WHO ARE WORKING IN THE LOCATION CHICAGO. */
SELECT ENAME,SAL
FROM EMP
WHERE DEPTNO = (SELECT DEPTNO FROM DEPT WHERE LOC = 'CHICAGO');

/* 28. WAQTD DETAILS OF THE EMPLOYEES WORKING IN SALES. */
SELECT * FROM EMP
WHERE DEPTNO = (SELECT DEPTNO FROM DEPT WHERE DNAME = 'SALES');

/* 29. WAQTD DETAILS OF THE EMP ALONG WITH ANNUAL SALARY IF EMPLOYEES ARE WORKING IN NEW YORK. */
SELECT EMP.*,SAL*12 "ANNUAL SAL"
FROM EMP
WHERE DEPTNO = (SELECT DEPTNO FROM DEPT WHERE LOC = 'NEW YORK');

/* 30. WAQTD NAMES OF EMPLOYEES WORKING IN OPERATIONS DEPARTMENT. */
SELECT ENAME
FROM EMP
WHERE DEPTNO = (SELECT DEPTNO FROM DEPT WHERE DNAME = 'OPERATIONS');
____________________________________________________________________________________________________________________

/* ASSIGNMENT ON CASE 1 & 2 */

/* 31. WAQTD NAMES OF THE EMPLOYEES EARNING MORE THAN SCOTT IN ACCOUNTING DEPT. */
SELECT ENAME
FROM EMP
WHERE SAL > (SELECT SAL FROM EMP WHERE ENAME = 'SCOTT') AND DEPTNO = (SELECT DEPTNO FROM DEPT WHERE DNAME = 'ACCOUNTING');

/* 32. WAQTD DETAILS OF THE EMPLOYEES WORKING AS MANAGER IN THE LOCATION CHICAGO. */
SELECT * FROM EMP
WHERE JOB = 'MANAGER' AND DEPTNO = (SELECT DEPTNO FROM DEPT WHERE LOC = 'CHICAGO');

/* 33. WAQTD NAME AND SAL OF THE EMPLOYEES EARNING MORE THAN KING IN THE DEPT ACCOUNTING. */
SELECT ENAME,SAL
FROM EMP
WHERE SAL > (SELECT SAL FROM EMP WHERE ENAME = 'KING') AND DEPTNO = (SELECT DEPTNO FROM DEPT WHERE DNAME = 'ACCOUNTING');

/* 34. WAQTD DETAILS OF THE EMPLOYEES WORKING AS SALESMAN IN THE DEPARTEMENT SALES. */
SELECT * FROM EMP
WHERE JOB = 'SALESMAN' AND DEPTNO = (SELECT DEPTNO FROM DEPT WHERE DNAME = 'SALES');

/* 35. WAQTD NAME, SAL, JOB, HIREDATE OF THE EMPLOYEES WORKING IN OPERATIONS DEPARTMENT AND HIRED BEFORE KING. */
SELECT ENAME,SAL,JOB,HIREDATE
FROM EMP
WHERE DEPTNO = (SELECT DEPTNO FROM DEPT WHERE DNAME = 'OPERATIONS') AND HIREDATE < (SELECT HIREDATE FROM EMP WHERE ENAME = 'KING');

/* 36. DISPLAY ALL THE EMPLOYEES WHOSE DEPARTMET NAMES ENDING 'S'. */
SELECT * FROM EMP
WHERE DEPTNO IN (SELECT DEPTNO FROM DEPT WHERE DNAME LIKE '%S');

/* 37. WAQTD DNAME OF THE EMPLOYEES WHOSE NAMES HAS CHARACTER 'A' IN IT. */
SELECT DNAME
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO FROM EMP WHERE ENAME LIKE '%A%');

/* 38. WAQTD DNAME AND LOC OF THE EMPLOYEES WHOS SALARY IS RUPEES 800. */
SELECT DNAME,LOC
FROM DEPT
WHERE DEPTNO = (SELECT DEPTNO FROM EMP  WHERE SAL = 800);

/* 39. WAQTD DNAME OF THE EMPLOYEES WHO EARN COMISSION. */
SELECT DNAME
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO FROM EMP WHERE COMM IS NOT NULL);

/* 40. WAQTD LOC OF THE EMPLOYEES IF THEY EARN COMISSION IN DEPT 40. */
SELECT LOC
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO FROM EMP WHERE COMM IS NOT NULL) AND DEPTNO = 40;
_________________________________________________________________________________________________________________

/* ASSIGNMENT ON SUBQUERIES USING GROUP BY AND HAVING CLAUSE */

/* 1. Find departments where average salary is more than the overall average salary. */
SELECT DNAME
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO FROM EMP GROUP BY DEPTNO HAVING AVG(SAL) > (SELECT AVG(SAL) FROM EMP));

/* 2. Departments where average salary is greater than the overall company average salary. */
SELECT DNAME, AVG(SAL) AS avg_sal
FROM EMP, DEPT
WHERE EMP.DEPTNO = DEPT.DEPTNO
GROUP BY DNAME
HAVING AVG(SAL) > (SELECT AVG(SAL) FROM EMP);

/* 3. Departments with more employees than the average number of employees per department. */
SELECT DNAME
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO FROM EMP GROUP BY DEPTNO HAVING COUNT(*) > (SELECT AVG(COUNT(*)) FROM EMP GROUP BY DEPTNO));

/* 4. Employees who earn more than the average salary of their department. */
SELECT ENAME
FROM EMP
WHERE SAL > (SELECT AVG(SAL) FROM EMP WHERE DEPTNO IN (SELECT DEPTNO FROM EMP));

/* 5. Departments where total salary is higher than the total salary of department 10. */
SELECT DNAME
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO FROM EMP GROUP BY DEPTNO HAVING SUM(SAL) > (SELECT SUM(SAL) FROM EMP WHERE DEPTNO = 10)); 

/* 6. Departments having more than 2 employees with salary above 3000. */
SELECT DNAME
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO FROM EMP WHERE SAL > 3000 GROUP BY DEPTNO HAVING COUNT(*) > 2);

/* 7. List departments where maximum salary is higher than the maximum salary of department 20. */
SELECT DNAME
FROM DEPT
WHERE DEPTNO IN(SELECT DEPTNO FROM EMP GROUP BY DEPTNO HAVING MAX(SAL) > (SELECT MAX(SAL) FROM EMP WHERE DEPTNO = 20));

/* 8. Departments where the number of managers is more than 1. */
SELECT DNAME
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO FROM EMP WHERE JOB = 'MANAGER' GROUP BY DEPTNO HAVING COUNT(*) > 1);

/* 9. Employees whose salary is greater than the average salary of all managers. */
SELECT ENAME
FROM EMP
WHERE SAL > (SELECT AVG(SAL) FROM EMP WHERE JOB = 'MANAGER');

/* 10. Departments where the minimum salary is less than the overall company minimum salary. */
SELECT DNAME
FROM DEPT
WHERE DEPTNO IN(SELECT DEPTNO FROM EMP GROUP BY DEPTNO HAVING MIN(SAL) < (SELECT MIN(SAL) FROM EMP));
_________________________________________________________________________________________________________________

/* ASSIGNMENT ON TYPES OF SUB QUERY. */

/* 51. WAQTD NAME OF THE EMPLOYEES EARNING SALARY MORE THAN THE MANAGER'S?. */
SELECT ENAME
FROM EMP
WHERE SAL > ALL (SELECT SAL FROM EMP WHERE JOB IN ('MANAGER'));

/* 52. WAQTD DETAILS OF THE EMPLOYEES HIRED AFTER ALL THE CLERKS. */
SELECT * FROM EMP
WHERE HIREDATE > ALL(SELECT HIREDATE FROM EMP WHERE JOB IN('CLERK'));

/* 53. WAQTD NAME AND SALARY FOR ALL THE EMPLOYEES IF THEY ARE EARNING LESS THAN ATLEAST A MANAGER. */
SELECT ENAME,SAL
FROM EMP
WHERE SAL < ANY(SELECT SAL FROM EMP WHERE JOB IN ('MANAGER'));

/* 54. WAQTD NAME AND HIREDATE OF EMPLOYEES HIRED BEFORE ALL THE MANAGERS. */
SELECT ENAME,HIREDATE
FROM EMP
WHERE HIREDATE < ALL(SELECT HIREDATE FROM EMP WHERE JOB IN('MANAGER'));

/* 55. WAQTD NAMES OF THE EMPLOYEES HIRED AFTER ALL THE MANAGERS AND EARNING SALARY MORE THAN ALL THE CLERKS. */
SELECT ENAME
FROM EMP
WHERE HIREDATE > ALL(SELECT HIREDATE FROM EMP WHERE JOB IN('MANAGER')) AND SAL > ALL(SELECT SAL FROM EMP WHERE JOB IN ('CLERK'));

/* 56. WAQTD DETAILS OF THE EMPLOYEES WORKING AS CLERK AND HIRED BEFORE ATLEST A SALESMAN. */
SELECT * FROM EMP
WHERE JOB IN('CLERK') AND HIREDATE < ANY(SELECT HIREDATE FROM EMP WHERE JOB IN ('SALESMAN'));

/* 57. WAQTD DETAILS OF EMPLOYEES WORKING IN ACCOUNTING OR SALES DEPT. */
SELECT * FROM EMP
WHERE DEPTNO IN (SELECT DEPTNO FROM DEPT WHERE DNAME IN('ACCOUNTING','SALES'));

/* 58. WAQTD DEPARTMENT NAMES OF THE EMPLOYEES WITH NAME SMITH , KING AND MILLER. */
SELECT DNAME
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO FROM EMP WHERE ENAME IN ('SMITH','KING','MILLER'));

/* 59. WAQTD DETAILS OF EMPLOYEES WORKING NEWYORK OR CHICAGO. */
SELECT * FROM EMP
WHERE DEPTNO IN (SELECT DEPTNO FROM DEPT WHERE LOC IN('NEW YORK','CHICAGO'));

/* 60. WAQTD EMP NAMES IF EMPLOYEES ARE HIRED AFTER ALL THE EMPLOYEES OF DEPT 30. */
SELECT ENAME
FROM EMP 
WHERE HIREDATE > ALL(SELECT HIREDATE FROM EMP WHERE DEPTNO = 30);

_________________________________________________________________________________________________________________

/* ASSIGNMENT ON MAX & MIN :

/* 41. WAQTD NAME OF THE EMPLOYEE EARNING MAXIMUM SALARY. */
SELECT ENAME
FROM EMP
WHERE SAL >= ALL (SELECT SAL FROM EMP);

/* 42. WAQTD NAME OF THE EMPLOYEE EARNING MINIMUM SALARY. */
SELECT ENAME
FROM EMP
WHERE SAL <= ALL (SELECT SAL FROM EMP);

/* 43. WAQTD NAME AND HIREDATE OF THE EMPLOYEE HIRED BEFORE ALL THE EMPLOYEES (FIRST EMP). */
SELECT ENAME, HIREDATE
FROM EMP
WHERE HIREDATE <= ALL (SELECT HIREDATE FROM EMP);

/* 44. WAQTD NAME AND HIREDATE OF THE EMPLOYEES HIRED AT THE LAST. */
SELECT ENAME, HIREDATE
FROM EMP
WHERE HIREDATE >= ALL (SELECT HIREDATE FROM EMP);

/* 45. WAQTD NAME, COMM OF THE EMPLOYEE WHO EARNS MIN COMMISSION. */
SELECT ENAME, COMM
FROM EMP
WHERE COMM <= ALL (SELECT COMM FROM EMP WHERE COMM IS NOT NULL);

/* 46. WAQTD NAME, SAL AND COMM OF THE EMPLOYEE EARNING MAXIMUM COMMISSION. */
SELECT ENAME, SAL, COMM
FROM EMP
WHERE COMM >= ALL (SELECT COMM FROM EMP WHERE COMM IS NOT NULL);

/* 47. WAQTD DETAILS OF THE EMPLOYEE WHO HAS GREATEST EMPNO. */
SELECT *
FROM EMP
WHERE EMPNO >= ALL (SELECT EMPNO FROM EMP);

/* 48. WAQTD DETAILS OF THE EMPLOYEES HAVING THE LEAST HIREDATE. */
SELECT *
FROM EMP
WHERE HIREDATE <= ALL (SELECT HIREDATE FROM EMP);

/* 49. WAQTD DETAILS OF THE EMPLOYEES EARNING LEAST ANNUAL SALARY. */
SELECT *
FROM EMP
WHERE SAL*12 <= ALL(SELECT SAL*12 FROM EMP);

/* 50. WAQTD NAME, ANNUAL SALARY OF THE EMPLOYEES IF THEIR ANNUAL SALARY IS MORE THAN ALL THE SALESMAN. */
SELECT ENAME, (SAL*12 + NVL(COMM,0)) AS ANNSAL
FROM EMP
WHERE (SAL*12 + NVL(COMM,0)) > ALL
      (SELECT (SAL*12 + NVL(COMM,0)) FROM EMP WHERE JOB='SALESMAN');
_________________________________________________________________________________________________________________

/* ASSIGNMENT ON NESTED SUB QUERY : */

/* 61. WAQTD 2ND MINIMUM SALARY. */
SELECT MIN(SAL)
FROM EMP
WHERE SAL >(SELECT MIN(SAL) FROM EMP);

/* 62. WAQTD 4TH MAXIMUM SALARY. */
SELECT MAX(SAL)
FROM EMP
WHERE SAL IN (SELECT MAX(SAL) FROM EMP 
WHERE SAL < (SELECT MAX(SAL) FROM EMP 
WHERE SAL < (SELECT MAX(SAL) FROM EMP 
WHERE SAL < (SELECT MAX(SAL) FROM EMP ))));

/* 63. WAQTD NAME, SALARY OF THE EMPLOYEE EARNING 4TH MAXIMUM SALARY. */
SELECT ENAME,SAL
FROM EMP
WHERE SAL IN (SELECT MAX(SAL) FROM EMP 
WHERE SAL < (SELECT MAX(SAL) FROM EMP 
WHERE SAL < (SELECT MAX(SAL) FROM EMP 
WHERE SAL < (SELECT MAX(SAL) FROM EMP ))));

/* 64. WAQTD EMPNO OF THE EMPLOYEE EARNING 2ND MAXIMUM SALARY. */
SELECT EMPNO
FROM EMP
WHERE SAL IN (SELECT MAX(SAL) FROM EMP 
WHERE SAL < (SELECT MAX(SAL) FROM EMP ));

/* 65. WAQTD DEPARTMENT NAME OF AN EMPLOYEE GETTING 4TH MAX SAL. */
SELECT DNAME
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO FROM EMP 
WHERE SAL IN (SELECT MAX(SAL) FROM EMP 
WHERE SAL < (SELECT MAX(SAL) FROM EMP 
WHERE SAL < (SELECT MAX(SAL) FROM EMP 
WHERE SAL < (SELECT MAX(SAL) FROM EMP )))));

/* 66. WAQTD DETAILS OF THE EMPLOYEE WHO WAS HIRED 2ND. */
SELECT * FROM EMP
WHERE HIREDATE IN (SELECT MIN(HIREDATE) FROM EMP 
WHERE HIREDATE > (SELECT MIN(HIREDATE) FROM EMP));

/* 67. WAQTD NAME OF THE EMPLOYEE HIRED BEFORE THE LAST EMPLOYEE. */
SELECT ENAME
FROM EMP
WHERE HIREDATE IN (SELECT MAX(HIREDATE) FROM EMP
WHERE HIREDATE < (SELECT MAX(HIREDATE) FROM EMP));

/* 68. WAQTD LOC OF THE EMPLOYEE WHO WAS HIRED FIRST. */
SELECT LOC
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO FROM EMP
WHERE HIREDATE IN (SELECT MIN(HIREDATE) FROM EMP));

/* 69. WAQTD DETAILS OF THE EMPLOYEE EARNING 7TH MINIMUM SALARY. */
SELECT * FROM EMP
WHERE SAL IN (SELECT MIN(SAL) FROM EMP
WHERE SAL > (SELECT MIN(SAL) FROM EMP
WHERE SAL > (SELECT MIN(SAL) FROM EMP
WHERE SAL > (SELECT MIN(SAL) FROM EMP
WHERE SAL > (SELECT MIN(SAL) FROM EMP
WHERE SAL > (SELECT MIN(SAL) FROM EMP))))));

/* 70. WAQTD DNAME OF EMPLOYEE GETTING 2ND MAXIMUM SALARY. */
SELECT DNAME 
FROM DEPT 
WHERE DEPTNO IN(SELECT DEPTNO FROM EMP
WHERE SAL IN (SELECT MAX(SAL) FROM EMP
WHERE SAL < (SELECT MAX(SAL) FROM EMP)));
_________________________________________________________________________________________________________________
/* ASSIGNMENT ON EMP AND MANAGER RELATION. */

/* 71. WAQTD MILLER'S REPORTING MANAGER'S NAME. */
SELECT ENAME
FROM EMP
WHERE EMPNO = (SELECT MGR FROM EMP WHERE ENAME = 'MILLER');

/* 72. WAQTD WARD'S MANAGER'S MANAGER NAME. */
SELECT ENAME
FROM EMP
WHERE EMPNO = (SELECT MGR FROM EMP WHERE EMPNO = (SELECT MGR FROM EMP WHERE ENAME = 'WARD'));

/* 73. WAQTD DNAME OF JONES MANAGER. */
SELECT DNAME
FROM DEPT
WHERE DEPTNO = (SELECT DEPTNO FROM EMP WHERE EMPNO = (SELECT MGR FROM EMP WHERE ENAME = 'JONES'));

/* 74. WAQTD SCOTT'S MANAGER'S NAME AND SALARY. */
SELECT ENAME,SAL
FROM EMP
WHERE EMPNO = (SELECT MGR FROM EMP WHERE ENAME = 'SCOTT');

/* 75. WAQTD LOC OF SCOTT'S MANAGER'S MANAGER. */
SELECT LOC
FROM DEPT
WHERE DEPTNO = (SELECT DEPTNO FROM EMP WHERE EMPNO = (SELECT MGR FROM EMP WHERE EMPNO = (SELECT MGR FROM EMP WHERE ENAME = 'SCOTT')));

/* 76. WAQTD NAMES OF THE EMPLOYEES REPORTING TO BLAKE . */
SELECT ENAME 
FROM EMP 
WHERE MGR = (SELECT EMPNO FROM EMP WHERE ENAME = 'BLAKE');

/* 77. WAQTD NUMBER OF EMPLOYEES REPORTING TO JONES. */
SELECT COUNT(*) 
FROM EMP 
WHERE MGR = (SELECT EMPNO FROM EMP WHERE ENAME = 'JONES');

/* 78. WAQTD DETAILS OF THE EMPLOYEES REPORTING TO SCOTT. */
SELECT * FROM EMP 
WHERE MGR = (SELECT EMPNO FROM EMP WHERE ENAME = 'SCOTT');

/* 79. WAQTD ENAMES OF THE EMPLOYEES REPORTING TO BLAKE'S MANAGER. */
SELECT ENAME 
FROM EMP 
WHERE MGR = (SELECT MGR FROM EMP WHERE ENAME = 'BLAKE');

/* 80. WAQTD DETAILS OF EMPLOYEES REPORTING TO FORD'S MANAGER'S MANAGER. */
SELECT * FROM EMP 
WHERE MGR = (SELECT MGR FROM EMP WHERE EMPNO = (SELECT MGR FROM EMP WHERE ENAME = 'FORD'));
_________________________________________________________________________________________________________________

/* ASSIGNMENT ON INNER JOIN : */

/* 1. NAME OF THE EMPLOYEE AND HIS LOCATION OF ALL THE EMPLOYEES. */
SELECT ENAME,LOC
FROM EMP INNER JOIN DEPT
ON EMP.DEPTNO = DEPT.DEPTNO;

/* 2. WAQTD DNAME AND SALARY FOR ALL THE EMPLOYEES WORKING IN ACCOUNTING. */
SELECT DNAME,SAL
FROM EMP INNER JOIN DEPT
ON EMP.DEPTNO = DEPT.DEPTNO
WHERE DNAME = 'ACCOUNTING';

/* 3. WAQTD DNAME AND ANNUAL SALARY FOR ALL EMPLOYEES WHOSE SALARY IS MORE THAN 2340. */
SELECT DNAME,SAL*12 "ANNUAL SAL"
FROM EMP INNER JOIN DEPT
ON EMP.DEPTNO = DEPT.DEPTNO
WHERE SAL > 2340;

/* 4. WAQTD ENAME AND DNAME FOR EMPLOYEES HAVING CHARACTER 'A' IN THEIR DNAME. */
SELECT ENAME,DNAME
FROM EMP INNER JOIN DEPT
ON EMP.DEPTNO = DEPT.DEPTNO
WHERE DNAME LIKE '%A%';

/* 5. WAQTD ENAME AND DNAME FOR ALL THE EMPLOYEES WORKING AS SALESMAN. */
SELECT ENAME,DNAME
FROM EMP INNER JOIN DEPT
ON EMP.DEPTNO = DEPT.DEPTNO
WHERE JOB = 'SALESMAN';

/* 6. WAQTD DNAME AND JOB FOR ALL THE EMPLOYEES WHOSE JOB AND DNAME STARTS WITH CHARACTER 'S'. */
SELECT DNAME,JOB
FROM EMP INNER JOIN DEPT
ON EMP.DEPTNO = DEPT.DEPTNO
WHERE JOB LIKE 'S%' AND DNAME LIKE 'S%';

/* 7. WAQTD DNAME AND MGR NO FOR EMPLOYEES REPORTING TO 7839. */
SELECT DNAME,MGR
FROM EMP INNER JOIN DEPT
ON EMP.DEPTNO = DEPT.DEPTNO
WHERE MGR = 7839;

/* 8. WAQTD DNAME AND HIREDATE FOR EMPLOYEES HIRED AFTER 83 INTO ACCOUNTING OR RESEARCH DEPT. */
SELECT DNAME,HIREDATE
FROM EMP INNER JOIN DEPT
ON EMP.DEPTNO = DEPT.DEPTNO
WHERE HIREDATE > '01-JAN-1983' AND DNAME IN('ACCOUNTING','RESEARCH');

/* 9. WAQTD ENAME AND DNAME OF THE EMPLOYEES WHO ARE GETTING COMM IN DEPT 10 OR 30. */
SELECT ENAME,DNAME
FROM EMP INNER JOIN DEPT
ON EMP.DEPTNO = DEPT.DEPTNO
WHERE COMM IS NOT NULL AND EMP.DEPTNO IN(10,30);

/* 10. WAQTD DNAME AND EMPNO FOR ALL THE EMPLOYEES WHOSE EMPNO ARE (7839, 7902) AND ARE WORKING IN LOC NEW YORK. */
SELECT DNAME,EMPNO
FROM EMP INNER JOIN DEPT
ON EMP.DEPTNO = DEPT.DEPTNO
WHERE EMPNO IN(7839,7902) AND LOC IN('NEW YORK');

/* 11. List department names and total salary of employees in each department. */
SELECT DNAME,SUM(SAL) "TOTAL SAL"
FROM EMP INNER JOIN DEPT
ON EMP.DEPTNO = DEPT.DEPTNO
GROUP BY DNAME;

/* 12. List departments and the number of employees in each dept. */
SELECT DNAME,COUNT(*) "EMP COUNT"
FROM EMP INNER JOIN DEPT
ON EMP.DEPTNO = DEPT.DEPTNO
GROUP BY DNAME;

/* 13. List all employees whose salary is more than the average salary of their department. */
SELECT *
FROM EMP INNER JOIN DEPT
ON EMP.DEPTNO = DEPT.DEPTNO
WHERE SAL > ALL(SELECT AVG(SAL) FROM EMP GROUP BY DEPTNO );

/* 14. Find the highest paid employee in each department. */
SELECT ENAME,EMP.DEPTNO
FROM EMP INNER JOIN DEPT
ON EMP.DEPTNO = DEPT.DEPTNO
WHERE SAL IN(SELECT MAX(SAL) FROM EMP GROUP BY DEPTNO);

/* 15. List department names with average salary of their employees. */
SELECT DNAME,AVG(SAL)
FROM EMP INNER JOIN DEPT
ON EMP.DEPTNO = DEPT.DEPTNO
GROUP BY DNAME;

/* 16. Find departments having more than 3 employees. */
SELECT DNAME,COUNT(EMPNO)
FROM EMP INNER JOIN DEPT
ON EMP.DEPTNO =  DEPT.DEPTNO
GROUP BY DNAME
HAVING COUNT(EMPNO) > 3;

/* 17. Get job titles along with their department names. */
SELECT JOB,DNAME
FROM EMP INNER JOIN DEPT
ON EMP.DEPTNO = DEPT.DEPTNO;

/* 18. List departments where total salary paid is more than 10000. */
SELECT DNAME,SUM(SAL)
FROM EMP INNER JOIN DEPT
ON EMP.DEPTNO = DEPT.DEPTNO
GROUP BY DNAME
HAVING SUM(SAL) > 10000;

/* 19. Find employees who share the same job within the same department. */
SELECT ENAME
FROM EMP INNER JOIN DEPT
ON EMP.DEPTNO = DEPT.DEPTNO


/* 20. List employees and the department they work in, ordered by department name. */
SELECT ENAME,DNAME
FROM EMP INNER JOIN DEPT
ON EMP.DEPTNO = DEPT.DEPTNO
ORDER BY DNAME;

/* 21. Total salary per department (only show if total salary > 6000). */
SELECT DNAME,SUM(SAL)
FROM EMP INNER JOIN DEPT
ON EMP.DEPTNO = DEPT.DEPTNO
GROUP BY DNAME
HAVING SUM(SAL) > 6000;

/* 22. Departments with more than 5 employees. */
SELECT DNAME,COUNT(*)
FROM EMP INNER JOIN DEPT
ON EMP.DEPTNO = DEPT.DEPTNO
GROUP BY DNAME
HAVING COUNT(EMPNO) > 5;

/* 23. Average salary per department (only departments with avg salary > 2000). */


/* 24. Departments where max salary is above 2500. */


/* 25. Departments with at least one employee earning more than 3000. */


/* 26. Departments where the average commission is more than 500. */


/* 27. Locations with more than 3 employees. */


/* 28. Department-job combinations where average salary is between 2000 and 4000. */


/* 29. Get all department names with the number of employees. */


/* 30. Get total salary per department. */


/* 31. Find departments where the average salary is greater than 2500. */


/* 32. Count of employees in each department located in 'NEW YORK'. */


/* 33. List department name and number of managers in each department. */


/* 34. List departments where the total salary of employees is between 5000 and 10000. */


/* 35. Show department names and average salary for departments having more than 3 employees. */

_________________________________________________________________________________________________________________
/* Assignment on joining multiple tables. */

/* 1. List employees with their manager's name and their department name. */
SELECT E1.ENAME "EMP NAME",D1.DNAME "EMP DNAME",E2.ENAME "MGR NAME",D2.DNAME "MGR DNAME"
FROM EMP E1 INNER JOIN DEPT D1 ON E1.DEPTNO = D1.DEPTNO
            JOIN EMP E2 ON E1.MGR = E2.EMPNO
            INNER JOIN DEPT D2 ON E2.DEPTNO = D2.DEPTNO;

/* 2. List employees along with their manager sal, deptno and manager's manager's name. */
SELECT E1.ENAME "EMP NAME",E2.SAL "MGR SAL",E1.DEPTNO "EMP DEPTNO",E3.ENAME "MGR'S MGR NAME"
FROM EMP E1 JOIN EMP E2 ON E1.MGR = E2.EMPNO
            JOIN EMP E3 ON E2.MGR = E3.EMPNO;

/* 3. List each employee, their manager, manager’s manager, and department name. */
SELECT E1.ENAME "EMP NAME",E2.ENAME "MGR NAME",E3.ENAME "MGR'S MGR",D1.DNAME "EMP DNAME"
FROM EMP E1 JOIN EMP E2 ON E1.MGR = E2.EMPNO
            JOIN EMP E3 ON E2.MGR = E3.EMPNO
            INNER JOIN DEPT D1 ON E1.DEPTNO = D1.DEPTNO;

/* 4. List only those employees who have both a manager and a manager’s manager. */
SELECT E1.ENAME "EMP NAME",E2.ENAME "MGR NAME",E3.ENAME "MGR'S MGR NAME"
FROM EMP E1 JOIN EMP E2 ON E1.MGR = E2.EMPNO
            JOIN EMP E3 ON E2.MGR = E3.EMPNO;

/* 5. List all managers who have at least one employee reporting to them along with their department name. */
SELECT E2.ENAME "MGR NAME",D2.DNAME "MGR DNAME"
FROM EMP E2 JOIN EMP E1 ON E2.EMPNO = E1.MGR
            INNER JOIN DEPT D2 ON E2.DEPTNO = D2.DEPTNO;

/* 6. List each department, and the name of employees, their manager, and manager’s manager working in that department. */
SELECT D1.DNAME "DNAME",E1.ENAME "EMP NAME",E2.ENAME "MGR NAME",E3.ENAME "MGR'S MGR NAME"
FROM DEPT D1 INNER JOIN EMP E1 ON D1.DEPTNO = E1.DEPTNO
             JOIN EMP E2 ON E1.MGR = E2.EMPNO
             JOIN EMP E3 ON E2.MGR = E3.EMPNO;

/* 7. List all top-level managers (who are managers but don’t report to anyone). */
SELECT DISTINCT E2.ENAME "MGR NAME"
FROM EMP E1 JOIN EMP E2 ON E1.MGR = E2.EMPNO
WHERE E2.MGR IS NULL;

/* 8. Find employees whose manager and manager’s manager are in different departments. */
SELECT E1.ENAME "EMP NAME"
FROM EMP E1 JOIN EMP E2 ON E1.MGR = E2.EMPNO
            JOIN EMP E3 ON E2.MGR = E3.EMPNO
            WHERE E2.DEPTNO <> E3.DEPTNO;

/* 9. Find managers who manage employees across more than one department. */
SELECT E2.ENAME "MGR NAME",COUNT(DISTINCT E1.DEPTNO) "EMP DEPT COUNT"
FROM EMP E1 JOIN EMP E2 ON E1.MGR = E2.EMPNO
GROUP BY E2.ENAME
HAVING COUNT(DISTINCT E1.DEPTNO) > 1;

/* 10. List employees along with their department and all levels of management hierarchy (max. 2 levels). */
SELECT E1.ENAME "EMP NAME",D1.DNAME "EMP DNAME",E2.ENAME "MGR NAME",E3.ENAME "MGR'S MGR NAME"
FROM EMP E1 INNER JOIN DEPT D1 ON E1.DEPTNO = D1.DEPTNO
            JOIN EMP E2 ON E1.MGR = E2.EMPNO
            JOIN EMP E3 ON E2.MGR = E3.EMPNO;

_____________________________________________________________________________________________________________
/* ASSIGNMENT ON SINGLE ROW FUNCTIONS. */

/* Q1. WAQTD ENAME STARTS WITH 'A' WITHOUT USING LIKE OPERATOR? */
SELECT ENAME
FROM EMP
WHERE SUBSTR(ENAME,1,1) = 'A';

/* Q2. ENAME ENDS WITH 'R' FROM EMP TABLE WITHOUT USING LIKE OPERATOR? */
SELECT ENAME
FROM EMP
WHERE SUBSTR(ENAME,-1,1) = 'R';

/* Q3. NAMES OF EMPLOYEE WHO'S NAME IS STARTING WITH VOWELS? */
SELECT ENAME
FROM EMP
WHERE SUBSTR(ENAME,1,1) IN ('A','E','I','O','U');

/* Q4. NAMES OF EMPLOYEE'S WHO HAVE FIRST AND LAST CHAR ARE SAME IN THEIR NAME? */
SELECT ENAME
FROM EMP
WHERE SUBSTR(ENAME,1,1) = SUBSTR(ENAME,-1,1);

/* Q5. WAQTD HALF OF THE NAME FROM COLUMN ENAME IN EMP TABLE? */
SELECT SUBSTR(ENAME,1,LENGTH(ENAME)/2)
FROM EMP;

/* Q6. WAQTD LAST 2ND CHAR AS 'E' */
SELECT ENAME
FROM EMP
WHERE SUBSTR(ENAME,-2,1) = 'E';

/* Q7. WAQTD LAST 2 CHAR ARE CONSEQUATIVE 'T' */
SELECT ENAME
FROM EMP
WHERE SUBSTR(ENAME,-1,2) = 'T';
________________________________________________________________________________________

/* 1. CREATE A TABLE WITH 5 COLS, 5 RECORDS..TABNAME = NEXUS_MALL (BRAND_NAME,PRODUCT_PRICE,PRODUCT_ID,PRODUCT_NAME,)*/
CREATE TABLE NEXUS_MALL
(
      BRAND_NAME VARCHAR(20) PRIMARY KEY
      PROD_ID CHAR(5) UNIQUE
      PROD_NAME VARCHAR(20) NOT NULL
      PROD_CATEGORY VARCHAR(10) NOT NULL
      PROD_PRICE NUMBER(6)
      PROD_DESCRIPTION VARCHAR(50)
);

INSERT INTO NEXUS_MALL VALUES ('&BRAND_NAME','&PROD_ID','&PROD_NAME','&PROD_CATEGORY','&PROD_PRICE','&PROD_DESCRIPTION');

/* 2.CREATE 5 COLS ,5 RECORDS TAB_NAME= LULU_MALL */
CREATE TABLE LULU_MALL
(
      BRAND_NAME VARCHAR(20)
      PROD_ID CHAR(5) UNIQUE
      PROD_NAME VARCHAR(20) NOT NULL
      PROD_CATEGORY VARCHAR(10) NOT NULL
      PROD_PRICE NUMBER(6)
      PROD_DESCRIPTION VARCHAR(50)
);

INSERT INTO LULU_MALL VALUES ('&BRAND_NAME','&PROD_ID','&PROD_NAME','&PROD_CATEGORY','&PROD_PRICE','&PROD_DESCRIPTION');

/* 3.CONNECT WITH THE FOREIGN KEY COL NAME CALLED AS BRAND_NAME */
ALTER TABLE LULU_MALL
ADD FOREIGN KEY (BRAND_NAME) REFERENCES NEXUS_MALL(BRAND_NAME);

/* NOTE : WAQ FOR THE FOLLOWING REQUIREMENTS: */

	/*  A. UPDATE BRAND_NAME TO COMPANY_NAME. */
            ALTER TABLE NEXUS_MALL
            RENAME COLUMN BRAND_NAME TO COMPANY_NAME;

            ALTER TABLE LULU_MALL
            RENAME COLUMN BRAND_NAME TO COMPANY_NAME;

	/*  B. APPLY INNER JOINS WITH YOUR OWN EXAMPLES OF WRITING QUERY. */
            SELECT N.PROD_NAME,L.PRODUCT_NAME
            FROM NEXUS_MALL N INNER JOIN LULU_MALL L
            ON N.BRAND_NAME = L.BRAND_NAME;

	/*  C. DELETE ONE COLUMNS IN BOTH THE TABLES. */
            ALTER TABLE NEXUS_MALL
            DROP COLUMN PROD_DESCRIPTION;

            ALTER TABLE LULU_MALL
            DROP COLUMN PROD_DESCRIPTION;

	/*  D. APPLY ALL AGGREGATE FUNCTIONS ON NEXUS MALL TABLE. */
            SELECT COUNT(*)
            FROM NEXUS_MALL
            WHERE BRAND_NAME = 'NIKE';

            SELECT AVG(PROD_PRICE) "AVG PRICE"
            FROM NEXUS_MALL;

            SELECT SUM(PROD_PRICE) "TOTAL PRICE"
            FROM NEXUS_MALL;

            SELECT MIN(PROD_PRICE) "MIN PRICE"
            FROM NEXUS_MALL;

            SELECT MAX(PROD_PRICE) "MAX PRICE"
            FROM NEXUS_MALL;


	/*  E. PERFORM SUB QUERY CASE 1 WITH YOUR OWN EXAMPLE. */
            SELECT BRAND_NAME
            FROM NEXUS_MALL
            WHERE PRODUCT_PRICE > (SELECT PRODUCT_PRICE FROM NEXUS_MALL WHERE BRAND_NAME = 'PUMA');

	/*  F. DROP NEXUS MALL TABLE AND LULU MALL TABLE AND FLASHBACK BOTH THE TABLES. */
            DROP TABLE NEXUS_MALL;
            DROP TABLE LULU_MALL;
            FLASHBACK TABLE NEXUS_MALL TO BEFORE DROP;
            FLASHBACK TABLE LULU_MALL TO BEFORE DROP;
________________________________________________________________________________________
/* ASSIGNMENT ON DATE FUNCTIONS: */

/* Basic Level */

/* 1.Display today’s system date in the format DD-MON-YYYY. */
SELECT TO_CHAR(SYSDATE,'DD-MON-YYYY')
FROM DUAL;

/* 2.Find the current date and time using SYSDATE. */
SELECT TO_CHAR(SYSDATE,'DD-MM-YYYY-HH24:MI:SS')
FROM DUAL;

/* 3.Show the date 7 days from today. */
SELECT SYSDATE+7
FROM DUAL;

/* 4.Show the date 30 days before today. */
SELECT SYSDATE-30
FROM DUAL;

/* 5.Display the last day of the current month. */
SELECT LAST_DAY(SYSDATE) "LAST DATE"
FROM DUAL;

/* 6.Display the first day of the current month using TRUNC. */
SELECT TRUNC(SYSDATE,'MM') "First_Day_of_Month" 
FROM DUAL;

/* 7.Display the current date rounded to the nearest month. */
SELECT ROUND(SYSDATE,'MM') "ROUNDED DATE"
FROM DUAL;

/* 8.Display the current date truncated to the start of the year. */
SELECT TRUNC(SYSDATE,'YYYY') "TRUNCATED DATE"
FROM DUAL;

/* 9.Show the next Sunday after today’s date. */
SELECT NEXT_DAY(SYSDATE,'SUNDAY') "NEXT SUNDAY"
FROM DUAL;

/* 10.Display the number of months between today and 01-JAN-2020. */
SELECT TRUNC(MONTHS_BETWEEN(SYSDATE,TO_DATE('01-JAN-2020','DD-MON-YYYY'))) "NO.OF MONTHS"
FROM DUAL;

SELECT TRUNC(MONTHS_BETWEEN(SYSDATE,'01-JAN-2020')) "NO.OF MONTHS"
FROM DUAL;

---

/* Intermediate Level */

/* 1.For each employee, display EMP_NAME, JOIN_DATE, and the number of months they have worked (use MONTHS_BETWEEN). */
SELECT ENAME,HIREDATE,TRUNC(MONTHS_BETWEEN(SYSDATE,HIREDATE))||'MONTHS' "NO. OF MONTHS"
FROM EMP;

/* 2.For each employee, calculate their 2-year completion date from JOIN_DATE using ADD_MONTHS. */
SELECT ENAME,HIREDATE,ADD_MONTHS(HIREDATE,12*2) "2 YRS COMPLETION"
FROM EMP;

/* 3.List all employees who joined in the last 6 months. */
SELECT * FROM EMP
WHERE HIREDATE>=(SELECT ADD_MONTHS(SYSDATE,-6) FROM DUAL);

/* 4.Display all employees whose next increment date (12 months after joining) is before today. */
SELECT * FROM EMP
WHERE ADD_MONTHS(HIREDATE,12)<SYSDATE;

/* 5.Show all employees whose service anniversary is this month. */
SELECT * FROM EMP
WHERE TO_CHAR(HIREDATE,'MM') = TO_CHAR(SYSDATE,'MM');

/* 6.Find the day of the week each employee joined. */
SELECT ENAME,HIREDATE,TO_CHAR(HIREDATE,'DAY') "DAY OF WEEK"
FROM EMP;

/* 7.Show all employees who joined on a Monday. */
SELECT * FROM EMP
WHERE TO_CHAR(HIREDATE,'DY')='MON';

/* 8.Display the difference in days between today and each employee’s join date. */
SELECT ENAME,HIREDATE,SYSDATE,TRUNC(SYSDATE-HIREDATE)||' DAYS' "DIFF"
FROM EMP;

/* 9.Find employees who will complete 5 years in the company within the next 6 months. */
SELECT ENAME,HIREDATE
FROM EMP
WHERE ADD_MONTHS(HIREDATE,12*5) BETWEEN SYSDATE AND ADD_MONTHS(SYSDATE,6);

/* 10.Show the hire date and last day of that hire month for each employee. */
SELECT ENAME,HIREDATE,LAST_DAY(HIREDATE) "LAST DAY OF MONTH"
FROM EMP;



---

/* Advanced Level */

/* 1.Display employees whose retirement date is after 30 years from their hire date. */
SELECT EMPNO, ENAME, HIREDATE, RETIRE_DATE
FROM EMP
WHERE RETIRE_DATE > ADD_MONTHS(HIREDATE, 12 * 30);

/* 2.For each department, find the earliest and latest hire dates and calculate the months between them. */
SELECT DEPTNO, MIN(HIREDATE) AS Earliest_Hire, MAX(HIREDATE) AS Latest_Hire,
       MONTHS_BETWEEN(MAX(HIREDATE), MIN(HIREDATE)) AS Months_Between
FROM EMP
GROUP BY DEPTNO;

/* 3.Show employees whose next birthday (using DOB) is within the next 30 days. */
SELECT EMPNO, ENAME, DOB,
       TO_DATE(TO_CHAR(SYSDATE, 'YYYY') || TO_CHAR(DOB, 'MMDD'), 'YYYYMMDD') AS Next_Birthday
FROM EMP
WHERE TO_DATE(TO_CHAR(SYSDATE, 'YYYY') || TO_CHAR(DOB, 'MMDD'), 'YYYYMMDD') BETWEEN SYSDATE AND SYSDATE + 30
   OR TO_DATE(TO_CHAR(SYSDATE + 365, 'YYYY') || TO_CHAR(DOB, 'MMDD'), 'YYYYMMDD') BETWEEN SYSDATE AND SYSDATE + 30;


/* 4.For each employee, display the number of days worked till now. */
SELECT EMPNO, ENAME, HIREDATE, SYSDATE - HIREDATE AS Days_Worked
FROM EMP;


/* 5.Find all employees who joined before the start of the current year. */
SELECT EMPNO, ENAME, HIREDATE
FROM EMP
WHERE HIREDATE < TRUNC(SYSDATE, 'YYYY');


/* 6.Display the first Monday of the next month. */
SELECT NEXT_DAY(TRUNC(ADD_MONTHS(SYSDATE, 1), 'MM') - 1, 'MONDAY') AS First_Monday_Next_Month
FROM DUAL;


/* 7.Display the number of weeks between two given dates. */
SELECT TRUNC((TO_DATE('2025-09-12', 'YYYY-MM-DD') - TO_DATE('2025-01-01', 'YYYY-MM-DD')) / 7) AS Weeks_Between
FROM DUAL;


/* 8.Show the quarter number in which each employee joined. */
SELECT EMPNO, ENAME, HIREDATE, TO_CHAR(HIREDATE, 'Q') AS Join_Quarter
FROM EMP;


/* 9.Find employees who have worked more than 1000 days. */
SELECT EMPNO, ENAME, HIREDATE, SYSDATE - HIREDATE AS Days_Worked
FROM EMP
WHERE SYSDATE - HIREDATE > 1000;


/* 10.Show the day name of each employee’s join date. */
SELECT EMPNO, ENAME, HIREDATE, TO_CHAR(HIREDATE, 'DAY', 'NLS_DATE_LANGUAGE=ENGLISH') AS Join_Day
FROM EMP;

________________________________________________________________________________________
SQL> SELECT * FROM EMP;

     EMPNO ENAME      JOB              MGR HIREDATE         SAL       COMM     DEPTNO
---------- ---------- --------- ---------- --------- ---------- ---------- ----------
      7369 SMITH      CLERK           7902 17-DEC-80        800                    20
      7499 ALLEN      SALESMAN        7698 20-FEB-81       1600        300         30
      7521 WARD       SALESMAN        7698 22-FEB-81       1250        500         30
      7566 JONES      MANAGER         7839 02-APR-81       2975                    20
      7654 MARTIN     SALESMAN        7698 28-SEP-81       1250       1400         30
      7698 BLAKE      MANAGER         7839 01-MAY-81       2850                    30
      7782 CLARK      MANAGER         7839 09-JUN-81       2450                    10
      7788 SCOTT      ANALYST         7566 19-APR-87       3000                    20
      7839 KING       PRESIDENT            17-NOV-81       5000                    10
      7844 TURNER     SALESMAN        7698 08-SEP-81       1500          0         30
      7876 ADAMS      CLERK           7788 23-MAY-87       1100                    20
      7900 JAMES      CLERK           7698 03-DEC-81        950                    30
      7902 FORD       ANALYST         7566 03-DEC-81       3000                    20
      7934 MILLER     CLERK           7782 23-JAN-82       1300                    10

14 rows selected.

SQL> SELECT * FROM DEPT;

    DEPTNO DNAME          LOC
---------- -------------- -------------
        10 ACCOUNTING     NEW YORK
        20 RESEARCH       DALLAS
        30 SALES          CHICAGO
        40 OPERATIONS     BOSTON

SQL>

_________________________________________________________________________________________
SPOOL "C:\Users\ajjup\OneDrive\Documents\Desktop\SQL TEST\GROUP BY_HAVING.txt";
/* GROUP BY AND HAVING */

/* 1. WRITE A QUERY TO DISPLAY TOTAL SALARY NEEDED TO PAY EACH JOB IN EMPLOYEE TABLE. */
SELECT SUM(SAL),JOB
FROM EMP
GROUP BY JOB;

/* 2. WRITE A QUERY TO DISPLAY THE HIRE DATE ON WHICH AT LEAST 3 EMPLOYEES WHERE HIRED.  */
SELECT HIREDATE
FROM EMP
GROUP BY HIREDATE
HAVING COUNT(*)>=3;

/* 3. WRITE A QUERY TO DISPLAY THE DEPARTMENT NUMBER WHICH HAS MORE THAN 2 EMPLOYEES AND THE TOTAL AMOUNT REQUIRED TO PAY THE MONTHLY SALARIES OF ALL THE EMPLOYEES IN THAT DEPARTMENT SHOULD BE MORE THAN 9000.  */
SELECT DEPTNO
FROM EMP
GROUP BY DEPTNO
HAVING COUNT(*)>2 AND SUM(SAL) > 9000;

/* 4. WRITE A QUERY TO DISPLAY NUMBER OF EMPLOYEES WORKING IN EACH DEPARTMENT AND ITS’ AVERAGE SALARY BY EXCLUDING ALL THE EMPLOYEES WHOSE SALARY IS LESS THAN THEIR COMMISSION.  */
SELECT COUNT(*),AVG(SAL),DEPTNO
FROM EMP
WHERE SAL>NVL(COMM,0)
GROUP BY DEPTNO;

/* 5. WRITE A QUERY TO DISPLAY THE SALARIES WHICH HAS REPETITIONS IN THE SAL COLUMN OF EMPLOYEE TABLE. */
SELECT SAL
FROM EMP
GROUP BY SAL
HAVING COUNT(SAL) > 1;

/* 6. WRITE A QUERY TO DISPLAY THE EMPLOYEE NAME ONLY IF MORE THAN ONE PERSON IN THE EMPLOYEES OF THE COMPANY HAS SAME NAME.  */
SELECT ENAME
FROM EMP
GROUP BY ENAME
HAVING COUNT(ENAME) > 1;

/* 7. WRITE A QUERY TO DISPLAY THE DEPARTMENT NUMBER WHOSE AVERAGE SALARY IS BETWEEN 2500 AND 3000.  */
SELECT DEPTNO
FROM EMP
GROUP BY DEPTNO
HAVING AVG(SAL) BETWEEN 2500 AND 3000;

/* 8. WRITE A QUERY TO DISPLAY THE NUMBER OF EMPLOYEES ONLY IF THEY ARE WORKING AS MANAGER OR ANALYST AND THEIR ANNUAL SAL SHOULD END WITH A ZERO, IN EACH DEPARTMENT.  */
SELECT COUNT(*)
FROM EMP
WHERE JOB IN ('MANAGER','ANALYST') AND SAL*12 LIKE '%0'
GROUP BY DEPTNO;

/* 9. WRITE A QUERY TO DISPLAY NO OF CLERKS WORKING IN EACH DEPARTMENT.  */
SELECT COUNT(JOB)
FROM EMP
WHERE JOB = 'CLERK'
GROUP BY DEPTNO;


/* 10. WRITE A QUERY TO DISPLAY HIGHEST SALARY GIVEN TO A MANAGER IN EACH DEPARTMENT. */
SELECT MAX(SAL)
FROM EMP
WHERE JOB = 'MANAGER'
GROUP BY DEPTNO;

/* 11. WRITE A QUERY TO DISPLAY NO OF TIMES THE SALARIES HAVE REPEATED IN THE EMP TABLE.*/
SELECT SAL,COUNT(SAL)
FROM EMP
GROUP BY SAL
HAVING COUNT(SAL)>=1;

/* 12.WRITE A QUERY TO DISPLAY DEPTNO AND MUNBER OF EMPLOYEES WHORKING IN EACH DEPARTMENT EXCEPT FOR THOSE WORKING IN DEPT 10  */
SELECT DEPTNO,COUNT(*)
FROM EMP
WHERE DEPTNO != 10
GROUP BY DEPTNO;

/* 13.WAQTD NUMBER OF EMPLOYEES GETTING COMISSION IN EACH DEPARTMENT */
SELECT COUNT(*),DEPTNO
FROM EMP
WHERE COMM IS NOT NULL
GROUP BY DEPTNO;

/* 14.WAQTD NUMBER OF EMPLOYEES GETTING SALARY MORE THAN 1600 EXCLUDING ALL THE MANAGERS IN EACH DEPARTEMNT */
SELECT COUNT(*),DEPTNO
FROM EMP
WHERE SAL>1600 AND JOB != 'MANAGER'
GROUP BY DEPTNO;

/* 15.WAQTD AVERAGE SALARY NEEDED TO PAY ALL THE EMPLOYEES WHO ARE HAVING A REPORTING MANAGER IN EACH JOB . */ 
SELECT AVG(SAL),JOB
FROM EMP
WHERE MGR IS NOT NULL
GROUP BY JOB;

/* 16.WAQTD NUMBER OF EMPLOYEES HIRED INTO THE SAME DEPARTMENT ON THE SAME DAY */
SELECT COUNT(*)
FROM EMP
GROUP BY HIREDATE
HAVING COUNT(HIREDATE)>1 AND COUNT(DEPTNO)>1;

/* 17.WAQTD NUMBER OF EMPLOYEES GETTING THE SAME SALARY , WORKING IN THE SAME DEPARTMENT  */
SELECT COUNT(*),SAL,DEPTNO
FROM EMP
GROUP BY DEPTNO,SAL
HAVING COUNT(SAL)>1 AND COUNT(DEPTNO)>1;

/* 18.WAQTD MAXIMUM SALARY GIVEN IN EACH DESIGNATION EXCLUDING THOSE WHOS NAME STARTS WITH ‘K’ */
SELECT MAX(SAL)
FROM EMP
WHERE ENAME NOT LIKE 'K%'
GROUP BY JOB;

/* 19.WAQTD NUMBER OF EMPLOYEES REPORTING TO 7839 IN EACH DEPT  */
SELECT COUNT(*)
FROM EMP
WHERE MGR = 7839
GROUP BY DEPTNO;

/* 20.WAQTD NUMBER OF EMPLOYEE NAMES STARTING WITH AN VOWEL IN EACH DEPARTMENT*/
SELECT COUNT(ENAME)
FROM EMP
WHERE SUBSTR(ENAME,1,1) IN ('A','E','I','O','U')
GROUP BY DEPTNO;
___________________________________________________________________________________________________________________________________________________________________________
SPOOL "C:\Users\ajjup\OneDrive\Documents\Desktop\SQL TEST\SUB QUERY.txt";
/* SUB QUERY */

/* 1.DISPLAY ALL THE EMPLOYEES WHOSE DEPARTMET NAMES ENDING 'S'  */ 
SELECT * FROM EMP
WHERE DEPTNO IN(SELECT DEPTNO FROM DEPT WHERE DNAME LIKE '%S');

/* 2.QUERY TO DISPLAY THE EMPLOYEE NAMES WHO IS HAVING MAXIMUM SALARY IN DEPT NAME "ACCOUNTING" */ 
SELECT ENAME
FROM EMP
WHERE SAL IN (SELECT MAX(SAL) FROM EMP WHERE DEPTNO IN (SELECT DEPTNO FROM DEPT WHERE DNAME = 'ACCOUNTING'));

/* 3.QUERY TO DISPLAY THE DEPT NAME WHO IS HAVING HIGHEST COMMISSION */ 
SELECT DNAME
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO FROM EMP WHERE COMM IN (SELECT MAX(COMM) FROM EMP));

/* 4. QUERY TO DISPLAY THE EMPLOYEE NAMES WHOSE DEPARTMENT NAME HAS 2ND CHARACTER AS 'O'. */ 
SELECT ENAME
FROM EMP
WHERE DEPTNO IN(SELECT DEPTNO FROM DEPT WHERE DNAME LIKE '_O%');

/* 5. QUERY TO DISPLAY ALL THE EMPLOYEES WHO’S DEPT NUMBER IS SAME AS SCOTT.  */ 
SELECT * FROM EMP
WHERE DEPTNO IN (SELECT DEPTNO FROM EMP WHERE ENAME='SCOTT');

/* 6.QUERY TO DISPLAY ALL THE EMPLOYEES IN 'OPERATIONS AND ACCOUNTING' DEPT. */ 
SELECT * FROM EMP
WHERE DEPTNO IN (SELECT DEPTNO FROM DEPT WHERE DNAME IN ('ACCOUNTING','OPERATIONS'));

/* 7.LIST THE EMPLOYEES WHO HAS SALARY GREATER THAN MILLER  */ 
SELECT * FROM EMP 
WHERE SAL > (SELECT SAL FROM EMP WHERE ENAME = 'MILLER');

/* 8. LIST DEPARTMENT NAME HAVING ATLEAST 3 SALESMAN */ 
SELECT DNAME
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO FROM EMP WHERE JOB='SALESMAN' GROUP BY DEPTNO HAVING COUNT(JOB)>=3);

SELECT DNAME
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO FROM EMP WHERE JOB='SALESMAN' AND DEPTNO IN(SELECT DEPTNO FROM EMP WHERE (SELECT COUNT(JOB) FROM EMP )>=3));

/* 9. DISPLAY THE DNAME OF AN EMPLOYEES WHO HAS NO REPORTING MANAGER.  */ 
SELECT DNAME
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO FROM EMP WHERE MRG IS NULL);

/* 10. LIST ALL THE EMPLOYEES WHO ARE REPORTING TO JONES MANAGER  */ 
SELECT * FROM EMP
WHERE MGR IN (SELECT MGR FROM EMP WHERE ENAME='JONES');

/* 11. LIST EMPLOYEES FROM RESEARCH&ACCOUNTING HAVING ATLEAST 2 REPORTING.  */ 
SELECT * FROM EMP E1
WHERE (SELECT COUNT(*) FROM EMP E2 WHERE E2.MGR = (SELECT E1.EMPNO FROM EMP E1))>=2 AND E1.DEPTNO IN(SELECT DEPTNO FROM DEPT WHERE DNAME IN ('RESEARCH','ACCOUNTING'));

                        SELECT E.ENAME, E.DEPTNO
                        FROM EMP E
                        WHERE E.DEPTNO IN (SELECT D.DEPTNO FROM DEPT D WHERE D.DNAME IN ('RESEARCH','ACCOUNTING'))
                        AND (SELECT COUNT(*) FROM EMP R WHERE R.MGR = E.EMPNO) >= 2;


/* 12. DISPLAY THE DEPARTMENT NAME OF THE EMPLOYEE WHOSE NAME DOES NOT STARTS WITH S AND SALARY BETWEEN 1500 TO 3000.  */ 
SELECT DNAME
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO FROM EMP WHERE ENAME NOT LIKE 'S%' AND SAL BETWEEN 1500 AND 3000);

/* 13.DISPLAY LOCATION OF EMPLOYEE WHOSE SALARY IS MINIMUM SALARY BUT SALARY IS GREATER THAN 2000  */ 


/* 14. DISPLAY THE LOCATION OF AN EMPLOYEE IN ACCOUNTING DEPARTMENT.  */ 


/* 15. DISPLAY THE DEPARTMENT ‘S LOCATION THAT IS HAVING GREATER THAN FOUR EMPLOYEES IN IT.  */ 


/* 16. WRITE A QUERY TO DISPLAY ALL THE EMPLOYEE WHOSE JOB NOT SAME AS ALLEN AND SALARY IS GREATER THAN MARTIN.  */ 


/* 17. DISPLAY ALL THE EMPLOYEES WHO IS HAVING LOCATION IS SAME AS ADAM'S MANAGER?  */ 


/* 18. DISPLAY THE JOB, MANAGER NUMBER OF EMPLOYEES WHO IS WORKING FOR JONES? */ 


/* 19. DISPLAY THE EMPLOYEE NAMES, HIGHER DATE, COMMISSION OF FORD'S MANAGER? */ 


/* 20. DISPLAY THE NUMBER OF EMPLOYEES WHO ARE GETTING SALARY LESS THAN THE BLAKE'S MANAGER  */ 


/* 21. LIST EMPLOYEES WHO LOCATED IN CHICAGO AND THEIR COMMISSION IS ZERO. */ 


/* 22. LIST EMPLOYEES WHO WORK FOR SALES DEPARTMENT AND THEIR SALARY GREATER THAN AVERAGE SALARY OF THEIR DEPARTMENT.  */ 


/* 23. LIST EMPLOYEES WHO ARE WORKING IN RESEARCH DEPARTMENT AND THEY ARE MANAGER.  */ 


/* 24. DISPLAY DEPARTMENT NAME OF THE EMPLOYEES WHO EARN COMMISSION.  */ 


/* 25. DISPLAY DEPARTMENT NAME OF THE EMPLOYEE WHO EARN MAXIMUM SALARY AND HAVE NO REPORTING MANAGER.  */ 


/* 26. DISPLAY EMPLOYEE DETAILS WHO ARE REPORTING TO BLAKE AND HAVE COMMISSION WITHOUT USING NULL OR NOT NULL. */


/* 27. LIST ALL THE DEPTNAME AND LOC OF ALL THE SALESMAN MANAGER-MANAGER'S. */


/* 28. LIST THE EMPLOYEE DEPTNAME AND LOC OF ALL THE EMPLOYEES WHO ARE CLERK ,REPORTING TO BLAKE AND SALARY IS LESSER THAN MARTIN SALARY. */


/* 29. LIST THE EMPLOYEES WHO DOES NOT DIRECTLY REPORT TO PRESIDENT,HAVE COMMISSION AND SALARY MORE THAN MAX SALARY OF ALL THE CLERK WITHOUT USING NULL OR NOT NULL. */


/* 30. LIST THE EMPLOYEES WHO JOINED AFTER 2 YEARS OF FIRST EMPLOYEE OF THE COMPANY AND MORE THAN BLAKE SALARY. */


/* 31. DISPLAY LOCATION OF ALL THE EMPLOYEES WHO REPORTING TO BLAKE. */


/* 32. LIST ALL THE EMPLOYEES WHOSE JOB IS SAME AS JONES AND THEIR SALARY LESSER THAN SCOTT. */


/* 33.DISPLAY ALL THE EMPLOYEES OF DEPARTMENT 30, 20 WITH THERE ANUAL SALARY AND HAVING ATLEAST 3 EMPLOYEES. */


/* 34.DISPLAY ALL THE EMPLOYEES WHO ARE EARN LESS THAN ANY OF THE SALESMAN? 35.DISPLAY ALL THE EMPLOYEES WHO ARE JOINED BEFORE THE LAST PERSON? */


/* 35.FIND 3RD MINIMUM SALARY IN THE EMPLOYEE TABLE. */


/* 36.DISPLAY ALL THE EMPLOYEES WHO ARE EARNING MORE THAN ANY OF THE MANAGER. */


/* 37.LIST EMPLOYEES WHO JOINED AFTER 4 YEARS OF 1ST EMPLOYEE OF THE COMPANY AND LESS THAN BLAKE SALARY. */


/* 38. DISPLAY THE DEPARTMENT INFORMATION OF EMPLOYEE WHO IS WORKING FOR NEW YORK LOCATION. */


/* 39. DISPLAY LOCATION OF EMPLOYEES, WHOSE NAME DOESN'T START WITH A AND SALARY BETWEEN 1000 AND 3000. */


/* 40. DISPLAY DEPARTMENT NAME OF ALL THE EMPLOYEES WHO ARE REPORTING TO BLAKE. */


/* 41. DISPLAY MARTIN'S MANAGER'S MANAGER'S DEPARTMENT NAME AND LOCATION. */


/* 42.DISPLAY THE MANAGER NUMBER,JOB AND DEPARTMENT NUMBER FOR THOSE WHO DON'T HAVE COMMISSION IN THE LOCATION CHICAGO OR DALLAS. */


/* 43.DISPLAY THE EMPLOYEE DETAILS WITH THEIR ANNUAL SALARY WHO EARN MAXIMUM COMMISSION. */


/* 44.DISPLAY ALL THE EMPLOYEE WHOSE DEPARTMENT IS SALES AND WHO IS EARNING SOME COMMISSION (I.E COMMISSION IS NOT NULL OR ZERO)AND WHO IS HIRED BEFORE THE LAST PERSON HIRED. */


/* 45.DISPLAY ALL THE DEPARTMENT NAMES FOR WARD'S MANAGER'S MANAGER. */


/* 46:DISPLAY DEPARTMENT NAMES OF EMPLOYEE'S WHOSE SALARY IS GREATER THAN AVERAGE SALARY OF ALL THE CLERK'S. */


/* 47.DISPLAY THE LAST EMPLOYEE RECORD WITH 25% HIKE IN SALARY. */


/* 48.DISPLAY THE DEPARTMENT NUMBER WHO WORKING IN SALES DEPARTMENT AND THEY ARE MANAGER. */


/* 49.DISPLAY DEPARTMENT NAME OF THE EMPLOYEE WHO EARN MINMUM SALARY AND HAVE REPORTING MANAGER. */
SELECT DNAME
FROM DEPT
WHERE DEPTNO = (SELECT DEPTNO FROM EMP WHERE SAL )

/* 50.DISPLAY HIREDATE AND JOB OF ALL THE EMPLOYEES WORKING FOR SALES. */
SELECT HIREDATE,JOB
FROM EMP
WHERE DEPTNO IN (SELECT DEPTNO FROM DEPT WHERE DNAME IN ('SALES'));




________________________________________________________________________________________
SPOOL "C:\Users\ajjup\OneDrive\Documents\Desktop\SQL TEST\INNER JOINS.txt";
/* INNER JOINS  */

/* 1.NAME OF THE EMPLOYEE AND HIS LOCATION OF ALL THE EMPLOYEES. */
SELECT E1.ENAME,D1.LOC
FROM EMP E1 INNER JOIN DEPT D1
ON E1.DEPTNO = D1.DEPTNO;

/* 2.WAQTD DNAME AND SALARY FOR ALL THE EMPLOYEE WORKING IN ACCOUNTING. */
SELECT D1.DNAME,E1.SAL
FROM EMP E1 INNER JOIN DEPT D1
ON E1.DEPTNO = D1.DEPTNO
WHERE DNAME = 'ACCOUNTING';

/* 3.WAQTD DNAME AND ANNUAL SALARY FOR ALL EMPLOYEES WHOS SALARY IS MORE THAN 2340. */
SELECT D1.DNAME,E1.SAL*12 "ANNUAL SAL"
FROM EMP E1 INNER JOIN DEPT D1
ON E1.DEPTNO = D1.DEPTNO
WHERE E1.SAL > 2340;

/* 4.WAQTD ENAME AND DNAME FOR EMPLOYEES HAVING CHARACTER 'A' IN THEIR DNAME */
SELECT E1.ENAME,D1.DNAME
FROM EMP E1 INNER JOIN DEPT D1
ON E1.DEPTNO = D1.DEPTNO
WHERE E1.ENAME LIKE '%S%';

/* 5.WAQTD ENAME AND DNAME FOR ALL THE EMPLOYEES WORKING AS SALESMAN. */
SELECT E1.ENAME,D1.DNAME
FROM EMP E1 INNER JOIN DEPT D1
ON E1.DEPTNO = D1.DEPTNO
WHERE E1.JOB IN ('SALESMAN');

/* 6.WADTD DNAME AND JOB FOR ALL THE EMPLOYEES WHOS JOB AND DNAME STARTS WITH CHARACTER 'S'. */
SELECT DISTINCT D1.DNAME,E1.JOB
FROM EMP E1 INNER JOIN DEPT D1
ON E1.DEPTNO = D1.DEPTNO
WHERE E1.JOB LIKE 'S%' AND D1.DNAME LIKE 'S%';

/* 7.WAQTD DNAME AND MGR NO FOR EMPLOYEES REPORTING TO 7839. */
SELECT D1.DNAME,E1.MGR
FROM EMP E1 INNER JOIN DEPT D1
ON E1.DEPTNO = D1.DEPTNO
WHERE E1.EMPNO = 7839;

/* 8.WAQTD DNAME AND HIREDATE FOR EMPLOYEES HIRED AFTER 83 INTO ACCOUNTING OR RESEARCH DEPT. */
SELECT D1.DNAME,E1.HIREDATE
FROM EMP E1 INNER JOIN DEPT D1
ON E1.DEPTNO = D1.DEPTNO
WHERE E1.HIREDATE > '31-DEC-1983' AND D1.DNAME IN('ACCOUNTING','RESEARCH');

/* 9.WAQTD ENAME AND DNAME OF THE EMPLOYEES WHO ARE GETTING COMM IN DEPT 10 OR 30. */
SELECT E1.ENAME,D1.DNAME
FROM EMP E1 INNER JOIN DEPT D1
ON E1.DEPTNO = D1.DEPTNO
WHERE E1.COMM >0 AND D1.DEPTNO IN (10,30);

/* 10.WAQTD DNAME AND EMPNO FOR ALL THE EMPLOYEES WHO'S EMPNO ARE (7839,7902) AND ARE WORKING IN LOC NEW YORK. */
SELECT D1.DNAME,E1.EMPNO
FROM DEPT D1 INNER JOIN EMP E1
ON D1.DEPTNO = E1.DEPTNO
WHERE E1.EMPNO IN(7839,7902) AND D1.LOC IN 'NEW YORK';

/* 11.WAQTD LOC AND AVERAGE SALARY GIVEN FOR EACH LOCATION BY EXCLUDING ALL THE EMPLOYEES WHOS SECOND CHAR IS A IN THEIR NAME. */
SELECT D1.LOC,AVG(E1.SAL) "AVG SAL"
FROM EMP E1 INNER JOIN DEPT D1
ON E1.DEPTNO = D1.DEPTNO
WHERE E1.ENAME NOT LIKE '_A%'
GROUP BY D1.LOC;

/* 12.WAQTD NAME OF THE EMP AND HIS LOC IF EMPLOYEE IS WORKING AS MANAGER AND WORKING UNDER THE EMPLOYEE WHOS EMPNO IS 7839. */
SELECT E1.ENAME,D1.LOC
FROM EMP E1 INNER JOIN DEPT D1
ON E1.DEPTNO = D1.DEPTNO
WHERE E1.JOB IN ('MANAGER') AND E1.MGR IN(7839);

/* 13.WAQTD DNAME AND EMPLOYEE ID'S OF ALL THE EMPLOYEES WHO ARE CLERKS AND HAVING REPORTING MANAGERS. */
SELECT D1.DNAME,E1.EMPNO
FROM EMP E1 INNER JOIN DEPT D1
ON E1.DEPTNO = D1.DEPTNO
WHERE E1.JOB IN ('CLERK') AND E1.MGR IS NOT NULL;

/* 14.WAQTD DNAME AND TOTAL SALARY GIVEN TO THAT DEPT IF THERE ARE ATLEAST 4 EMPLOYEES WORKING FOR EACH DEPT. */
SELECT D1.DNAME,SUM(E1.SAL) "TOTAL SAL"
FROM EMP E1 INNER JOIN DEPT D1
ON E1.DEPTNO = D1.DEPTNO
GROUP BY D1.DNAME
HAVING COUNT(E1.EMPNO) >=4;

/* 15.WAQTD DNAME AND NUMBER OF EMPLOYEES WORKING IN EACH DEPT ONLY IF THERE ARE MANAGER OR CLERKS. */
SELECT D1.DNAME,COUNT(*)
FROM EMP E1 INNER JOIN DEPT D1
ON E1.DEPTNO = D1.DEPTNO
WHERE E1.JOB IN('MANAGER','CLERK')
GROUP BY D1.DNAME;
_____________________________________________________________________________________________________________
/* ALL JOINS */

/* 1. LIST ENAME, JOB, ANNUAL SAL, DEPTNO, DNAME WHO EARN 30000 PER YEAR AND WHO ARE NOT CLERKS. */
SELECT E1.ENAME,E1.JOB,E1.SAL*12 "ANNUAL SAL",E1.DEPTNO,D1.DNAME
FROM EMP E1 INNER JOIN DEPT D1
ON E1.DEPTNO = D1.DEPTNO
WHERE E1.SAL*12 = 30000 AND E1.JOB != 'CLERK';

/* 2. LIST OUT THE ALL EMPLOYEES BY NAME AND EMPLOYEE NUMBER ALONG WITH THEIR MANAGER'S NAME AND EMPLOYEE NUMBER. */
SELECT E1.ENAME,E1.EMPNO,E1.ENAME,E2.EMPNO
FROM EMP E1 JOIN EMP E2
ON E1.MGR = E2.EMPNO;

/* 3. DISPLAY ENAME,DNAME EVEN IF THERE NO EMPLOYEES WORKING IN A PARTICULAR DEPARTMENT. */
SELECT E1.ENAME,D1.DNAME
FROM EMP E1 RIGHT JOIN DEPT D1
ON E1.DEPTNO = D1.DEPTNO;

/* 4. DISPLAY THE DEPARTMENT NAME ALONG WITH TOTAL SALARY IN EACH DEPARTMENT. */
SELECT D1.DNAME,SUM(E1.SAL) "TOTAL SAL"
FROM EMP E1 INNER JOIN DEPT D1
ON E1.DEPTNO = D1.DEPTNO
GROUP BY D1.DNAME;

/* 5. DISPLAY EMPLOYEE NAME AND DEPARTMENT NAME FOR EACH EMPLOYEE. */
SELECT E1.ENAME,D1.DNAME
FROM EMP E1 INNER JOIN DEPT D1
ON E1.DEPTNO = D1.DEPTNO;

/* 6. DISPLAY LOCATION NAME OF THE EMPLOYEE WHO EARN COMMISSION. */
SELECT DISTINCT(D1.LOC)
FROM EMP E1 INNER JOIN DEPT D1
ON E1.DEPTNO = D1.DEPTNO
WHERE COMM IS NOT NULL;

/* 7. DISPLAY DEPT NAME OF THE EMPLOYEE WHO EARN MIN SALARY AND HAVE NO REPORTING MANAGER. */
SELECT D1.DNAME
FROM EMP E1 INNER JOIN DEPT D1
ON E1.DEPTNO = D1.DEPTNO
WHERE MGR IS NULL AND E1.SAL IN (SELECT MIN(E1.SAL) FROM EMP);

/* 8. DISPLAY DEPT NAME,LOC OF ALL THE EMPLOYEES WHO ARE REPORTING TO SMITH. */
SELECT D1.DNAME,D1.LOC
FROM EMP E1 INNER JOIN DEPT D1
ON E1.DEPTNO = D1.DEPTNO
WHERE E1.MGR IN (SELECT EMPNO FROM EMP E1 WHERE E1.ENAME IN('SMITH'));

/* 9. LIST ALL THE DEPT NAME AND LOCATION OF ALL THE SALESMAN MANAGER'S MANAGER. */
SELECT DISTINCT(D1.DNAME),D1.LOC
FROM DEPT D1 INNER JOIN EMP E1
ON D1.DEPTNO = E1.DEPTNO
JOIN EMP E2 ON E1.EMPNO = E2.MGR
JOIN EMP E3 ON E2.EMPNO = E3.MGR
WHERE E3.JOB IN('SALESMAN');

/* 10. LIST EMPLOYEES WHO ARE WORKING IN RESEARCH DEPT AND THEY ARE MANAGER. */
SELECT *
FROM EMP E1 INNER JOIN DEPT D1
ON E1.DEPTNO = D1.DEPTNO
WHERE D1.E1.DNAME IN('RESEARCH') AND JOB IN ('MANAGER');

/* 11. DISPLAY THE NUMBER OF EMPLOYEES WHO ARE GETTING SALARY LESS THAN THE BLAKE'S MANAGER. */
SELECT COUNT(E1.EMPNO)
FROM EMP E1 JOIN EMP E2
ON E1.EMPNO = E2.MGR
WHERE E1.SAL < (SELECT E2.MGR FROM EMP E2 WHERE ENAME IN ('BLAKE'));

                        SELECT COUNT(E1.EMPNO)
                        FROM EMP E1 JOIN EMP E2 
                        ON E2.ENAME = 'BLAKE'
                        JOIN EMP M ON E2.MGR = M.EMPNO
                        WHERE E1.SAL < M.SAL;


/* 12. LIST THE EMPLOYEE DEPTNAME AND LOCATION OF ALL THE EMPLOYEES WHO ARE ANALYST,REPORTING TO BLAKE. */
SELECT D1.DNAME,D1.LOC
FROM DEPT D1 INNER JOIN EMP E1
ON D1.DEPTNO = E1.DEPTNO
JOIN EMP E2 ON E1.MGR = E2.EMPNO
WHERE E1.JOB IN('ANALYST') AND E2.ENAME IN ('BLAKE');

/* 13. DISPLAY THE EMPLOYEE NAMES,HIREDATE,COMM OF FORD'S MANAGER. */
SELECT E1.ENAME,E1.HIREDATE,E1.COMM
FROM EMP E1 JOIN EMP E2
ON E1.EMPNO = E2.MGR
WHERE E2.ENAME = 'FORD';

/* 14. DISPLAY ENAME, DNAME OF ALL THE EMPLOYEES WHOSE SALARY LESS THAN AVG SAL OF DEPT 30. */
SELECT E1.ENAME,D1.DNAME
FROM EMP E1 INNER JOIN DEPT D1
ON E1.DEPTNO = D1.DEPTNO
WHERE E1.SAL < (SELECT AVG(E2.SAL) FROM EMP E2 WHERE E2.DEPTNO = 30);

/* 15. DISPLAY ENAME,DNAME AND LOC OF ALL THE EMPLOYEES WHO ARE WORKING FOR JONES. */
SELECT E1.ENAME,D1.DNAME,D1.LOC
FROM EMP E1 INNER JOIN DEPT D1
ON E1.DEPTNO = D1.DEPTNO
WHERE E1.MGR IN (SELECT E2.EMPNO FROM EMP E2 WHERE E2.ENAME IN ('JONES'));

/* 16. DISPLAY ENAME DNAME OF ALL THE EMPLOYEES WHOSE NAME STARTS WITH ‘S’. */
SELECT E1.ENAME,D1.DNAME
FROM EMP E1 INNER JOIN DEPT D1
ON E1.DEPTNO = D1.DEPTNO
WHERE E1.ENAME LIKE 'S%';

/* 17. LIST THE DNAME WHO ARE NOT HAVING ANY EMPLOYEE IN IT. */
SELECT D1.DNAME
FROM DEPT D1 LEFT JOIN EMP E1
ON D1.DEPTNO = E1.DEPTNO
WHERE E1.EMPNO IS NULL;

/* 18. DISPLAY EMPLOYEE WHO ARE GETTING SAME COMMISSION. */
SELECT DISTINCT(E1.EMPNO),E1.ENAME,E1.COMM
FROM EMP E1 INNER JOIN EMP E2
ON E1.COMM = E2.COMM
WHERE E1.EMPNO != E2.EMPNO;

/* 19. DISPLAY ALL THE DEPT NAMES IRRESPECTIVE OF ANY EMPLOYEE WORKING IN IT OR NOT. IF AN EMPLOYEE IS WORKING DISPLAY HIS NAME. */
SELECT D1.DNAME,E1.ENAME
FROM DEPT D1 LEFT JOIN EMP E1
ON D1.DEPTNO = E1.DEPTNO;

/* 20. WRITE A QUERY TO DISPLAY EMPLOYEE NAME, JOB, DNAME, LOCATION OF ALL EMPLOYEES WHO ARE WORKING AS ACTUAL MANAGERS AND WORKS AT CHICAGO. */
SELECT E1.ENAME,E1.JOB,D1.DNAME,D1.LOC
FROM EMP E1 INNER JOIN DEPT D1
ON E1.DEPTNO = D1.DEPTNO
WHERE E1.JOB IN ('MANAGER') AND D1.LOC IN ('CHICAGO');

/* 21. LIST THE DEPARTMENT NAMES IN WHICH THE EMPLOYEES ARE HIRED BETWEEN 1ST OF JAN 1981 AND 31ST DEC 1982 WITH SALARY MORE THAN 1800. */
SELECT D1.DNAME
FROM DEPT D1 INNER JOIN EMP E1
ON D1.DEPTNO = E1.DEPTNO
WHERE E1.SAL>1800 AND E1.HIREDATE BETWEEN '01-JAN-1981' AND '31-DEC-1982';

/* 22. DISPLAY 2ND LEAST SALARY FROM EMPLOYEE TABLE. */
SELECT E1.SAL
FROM EMP E1 JOIN EMP E2
ON 

                              SELECT DISTINCT E1.SAL
                              FROM EMP E1
                              LEFT JOIN EMP E2 ON E1.SAL > E2.SAL
                              GROUP BY E1.SAL
                              HAVING COUNT(E2.SAL) = 1;


/* 23. LIST THE EMPLOYEES WHOSE ANNUAL SALARY IS GREATER THAN 1500 AND WHO ARE JOINED BEFORE 1982 ONLY. */
SELECT * FROM EMP
WHERE HIREDATE < '01-JAN-1982' AND SAL*12 > 1500;

/* 24. DISPLAY DNAME, LOC, DEPTNO OF EMPLOYEES WHO HAS SAME REPORTING MANAGER. */
SELECT D1.DNAME,D1.LOC,E1.DEPTNO
FROM DEPT D1 INNER JOIN EMP E1
ON D1.DEPTNO = E1.DEPTNO
JOIN EMP E2 ON E1.MGR = E2.MGR
WHERE E1.EMPNO != E2.EMPNO;

/* 25. DISPLAY EMPLOYEE NAME ALONG WITH THEIR MANAGER NAME. */
SELECT E1.ENAME,E2.ENAME
FROM EMP E1 JOIN EMP E2
ON E1.MGR = E2.EMPNO;

/* 26. DISPLAY EMPLOYEE NAME AND HIS DEPT NAME FOR THE EMPLOYEES WHOSE NAME STARTS WITH ‘S’. */
SELECT E1.ENAME,D1.DNAME
FROM EMP E1 INNER JOIN DEPT D1
ON E1.DEPTNO = D1.DEPTNO
WHERE E1.ENAME LIKE 'S%';

/* 27. DISPLAY EMPLOYEES WHO ARE GETTING SAME SALARY. */
SELECT DISTINCT (E1.ENAME),E1.SAL
FROM EMP E1 JOIN EMP E2
ON E1.SAL = E2.SAL AND E1.EMPNO != E2.EMPNO
ORDER BY E1.SAL;
